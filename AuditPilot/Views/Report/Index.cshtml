@model IEnumerable<SCardApp.Models.MAVGReportModel>

@{
                /**/

                ViewBag.Title = "Index";
}

<br />
<br />
<br />

@using (Html.BeginForm("Index", "Report", FormMethod.Post))
{
    <div class="row">
        <div class="col-lg-12 col-md-12 ">
            <table class="table">
                <tr>
                    <td>
                        <div class="col-xs-3">
                            <b>Module</b>
                            <span style="color:red; font-size:20px;">*</span>
                            @Html.DropDownList("Modules", new SelectList(ViewBag.RpModList, "ModuleId", "ModuleName"), "Select Module")
                        </div>
                        <div class="col-xs-3">
                            <b>Reports</b>
                            <span style="color:red; font-size:20px;">*</span>
                            <select id="drpreport"><option value="0">Select Report</option></select>
                        </div>
                        <div class="col-xs-3">
                            <b>ScoreCard</b>
                            <span style="color:red; font-size:20px;">*</span>
                            @Html.DropDownList("ScoreCard", new SelectList(ViewBag.ScList, "ScorecardID", "scorecardname"), "Select Scorecard")
                        </div>
                        <div class="col-xs-3">
                            <b>Teams</b>
                            <span style="color:red; font-size:20px;">*</span>
                            <select id="drprteam"><option value="0">Select Team</option></select>
                        </div>
                        <div class="col-xs-3">
                            <b>Agents</b>
                            <span style="color:red; font-size:20px;">*</span>
                            <select id="drpAgent"><option value="0">Select Agent</option></select>
                        </div>
                        <div class="col-xs-3">
                            <b>Duration</b>
                            <span style="color:red; font-size:20px;">*</span>
                            <select id="drpduration">
                                <option value="0">Select Agent</option>
                                <option value="1">Last Week</option>
                                <option value="2">This Week</option>
                                <option value="3">Last Month</option>
                                <option value="4">This Month</option>
                                <option value="5">Last 3 Month</option>
                                <option value="6">Last 6 Month</option>
                            </select>
                        </div>
                        <div class="col-xs-3">
                            <input type="submit" value="View Report" class="btn btn-primary btn-sm submitConversion" style="background-color: #742774 !important;" /> 
                        </div>

            <td>
      </table>
            </div>
        </div>
            }

            @if (Model != null && Model.Count() != 0)
            {
    <table class="table table-bordered" border="1" style="border-color:black !important">
        <tr>
            <td colspan="9" align="center"><b>Mean Average Score Report</b></td> <td>Export : <a href="#"><img src="~/images/excel.PNG" sizes="" /></a>&nbsp;<a href="#"><img src="~/images/pdf.PNG" sizes="" /></a> </td>
        </tr>
        <tr>
            <td colspan="10" align="center">Means Average Score <input type="text" id="txtmasavg" readonly size="5" value="@ViewBag.AvgA"></td>
        </tr>
        <tr>
            <td colspan="10" align="center">Parameter Average Score <input type="text" id="txtpmravg" readonly size="5" value="@ViewBag.AvgP"></td>
        </tr>
        <tr>
            <td colspan="10" align="center">Total Number of tickets audited during the duration <input type="text" id="txtadtcnt" readonly size="5" value="@ViewBag.ACnt"></td>
        </tr>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.AuditId)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AgentName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AuditedBy)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AuditDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.CustomerRating)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.AuditScore)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ParameterAverageScore)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Status)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Team)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.TeamLead)
            </th>
        </tr>

        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.AuditId)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.AgentName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.AuditedBy)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.AuditDate)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.CustomerRating)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.AuditScore)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.ParameterAverageScore)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Status)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Team)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.TeamLead)
                </td>
            </tr>
        }

    </table>
            }
